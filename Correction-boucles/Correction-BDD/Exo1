package Correction-BDD;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class Exo1 {
   public static void main(String[] args){
      try {
         //conection strings
         String url = "jdbc:mariadb://localhost:3306/films";
         String user = "root";
         String password = "";

         //connect
         Class.forName("org.mariadb.jdbc.Driver");
         Connection conn = DriverManager.getConnection(url, user, password);

         //request
         String sql = "SELECT idFilm, titre, année FROM Films WHERE année >= 2000 AND année <= 2015";
         PreparedStatement pstmt = conn.prepareStatement(sql);
         ResultSet rs = pstmt.executeQuery();

         while (rs.next()) {
            String colonne1 = rs.getString("idFilm");
            String colonne2 = rs.getString("titre");
            String colonne3 = rs.getString("année");

            System.out.println("id : " + colonne1 + ", titre : " + colonne2 + ", année : " + colonne3 + "</br>");
        }

        // Fermer les ressources 
        rs.close();
        pstmt.close();
        conn.close();
      }
      catch (Exception e) {
         System.err.println(e);
      }
   }
}
